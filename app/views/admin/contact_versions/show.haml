- contact = Contact.new(@version.object.to_h)
- @version.object_changes.to_h.each{|k,v| contact[k]=v.last}

= render 'shared/title', name: contact.name

.row
  .col-md-8
    .panel.panel-default{:style => "min-height:420px;"}
      .panel-heading
        %h3.panel-title
          = l(@version.created_at, format: :short)
          = @version.event
          = plain_username(@version.terminator)
      .panel-body
        %dl.dl-horizontal
          %dt= t(:id)
          %dd= contact.code

          %dt= t(:ident)
          %dd= ident_for(contact)

          - if contact.email.present?
            %dt= t(:email)
            %dd= contact.email

          - if contact.phone.present?
            %dt= t(:phone)
            %dd= contact.phone

          - if contact.fax.present?
            %dt= t(:fax)
            %dd= contact.fax

          %br

          %dt= t(:created)
          %dd
            = l(contact.created_at, format: :short)

          %dt= t(:updated)
          %dd
            = l(contact.updated_at, format: :short)

          %dt= t(:registrar)
          %dd
            - if contact.registrar.present?
              = link_to(contact.registrar, admin_registrar_path(contact.registrar))

        %dl.dl-horizontal
          - if contact.org_name.present?
            %dt= t(:org_name)
            %dd= contact.org_name

          - if contact.street.present?
            %dt= t(:street)
            %dd= contact.street.to_s.gsub("\n", '<br>').html_safe

          - if contact.city.present?
            %dt= t(:city)
            %dd= contact.city

          - if contact.zip.present?
            %dt= t(:zip)
            %dd= contact.zip

          - if contact.state.present?
            %dt= t(:state)
            %dd= contact.state

          - if contact.country.present?
            %dt= t(:country)
            %dd= contact.country


      %span{:style => "padding-right:10px; float: right;"}
        - if @version.previous
          = link_to(t(:previous),
                    admin_contact_version_path(@version.previous.id),
                    class: 'btn btn-primary')
        - else
          %a.btn.btn-primary.disabled{:href => "#"}
            %span= t(:previous)
        - if @version.next
          = link_to(t(:next),
                    admin_contact_version_path(@version.next.id),
                    class: 'btn btn-default')
        - else
          %a.btn.btn-default.disabled{:href => "#"}
            %span= t(:next)

  .col-md-4
    .panel.panel-default{:style => "min-height:420px;"}
      %ul.nav.nav-pills.nav-stacked
        - @versions.each do |vs|
          %li{class: (vs.id == @version.id) && :active}
            = link_to admin_contact_version_path(vs.id, page: params[:page]) do
              = l(vs.created_at, format: :short)
              = vs.event
      %span{:style => "padding-left:10px; position: absolute; bottom: 10px;"}
        = paginate @versions, theme: :admin