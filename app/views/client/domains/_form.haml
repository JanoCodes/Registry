= form_for([:client, @domain]) do |f|
  = render 'shared/errors', object: @domain
  - unless @domain.parent_valid?
    %hr
  .row
    .col-md-12
      / Nav tabs
      %ul.nav.nav-tabs{:role => "tablist", id: 'tabs'}
        - li_class = @domain.general_tab_valid? ? nil : 'error-tab'
        %li.active{class: li_class}
          %a{"data-toggle" => "tab", :href => "#general-tab", :role => "tab"}= t('shared.general')
        - li_class = @domain.statuses_tab_valid? ? nil : 'error-tab'
        %li{class: li_class}
          %a{"data-toggle" => "tab", :href => "#statuses-tab", :role => "tab"}= t('shared.statuses')
      / Tab panes
      .tab-content{style:'margin-top: 20px;'}
        #general-tab.tab-pane.active
          = render 'client/domains/form_partials/general', f: f
          %hr
          = render 'client/domains/form_partials/contacts', f: f
          %hr
          = render 'client/domains/form_partials/nameservers', f: f
          %hr
          = render 'client/domains/form_partials/dnskeys', f: f
        #statuses-tab.tab-pane
          = render 'client/domains/form_partials/statuses', f: f
  .row
    .col-md-12.text-right
      = button_tag(t('shared.save'), class: 'btn btn-primary')

:javascript
  $(function () {
    $('#tabs a:first').tab('show')
  })

  $("#domain_contacts").nestedAttributes({
    bindAddTo: $(".add-domain-contact"),
    afterAdd: function(item) {
      item.find('.errors').html('');
      item.find('.js-contact-id').val('')
      Autocomplete.bindClientContactSearch();
    }
  });

  Autocomplete.bindClientContactSearch();
