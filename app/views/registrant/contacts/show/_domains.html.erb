<% domains = contact.all_domains(page: params[:domain_page], per: 20, params:
    params.merge(leave_domains: domain_ids)) %>

<div class="panel panel-default" id="contacts">
    <div class="panel-heading">
        <div class="pull-left">
            <%= t '.header'%>
        </div>

        <div class="pull-right">
            <%= form_tag request.path, method: :get do %>
                <%= select_tag :domain_filter,
                               options_for_select(%w(Registrant AdminDomainContact TechDomainContact),
                                                  selected: params[:domain_filter]),
                               include_blank: true,
                               class: 'form-control2 selectize2' %>
                <button class="btn btn-primary">
                    <span class="glyphicon glyphicon-search"></span>
                </button>
            <% end %>
        </div>
        <div class="clearfix"></div>
    </div>

    <div class="table-responsive">
        <table class="table table-hover table-bordered table-condensed">
            <thead>
                <tr>
                    <th class="col-xs-3">
                        <%= custom_sort_link Domain.human_attribute_name(:name), :name %>
                    </th>
                    <th class="col-xs-3">
                        <%= custom_sort_link Registrar.model_name.human, :registrar_name %>
                    </th>
                    <th class="col-xs-3">
                        <%= custom_sort_link Domain.human_attribute_name(:valid_to), :valid_to %>
                    </th>
                    <th class="col-xs-3">
                        <%= custom_sort_link Domain.human_attribute_name(:roles), :roles %>
                    </th>
                </tr>
            </thead>
            <tbody>
            <% domains.each do |x| %>
                <tr>
                    <td>
                        <%= link_to(x.name, [:registrant, x]) %>
                    </td>
                    <td>
                        <%= link_to(x.registrar, [:registrant, x.registrar]) %>
                    </td>
                    <td>
                        <%= l(x.valid_to, format: :short) %>
                    </td>
                    <td>
                        <%= x.roles.join(", ") %>
                    </td>
                </tr>
            <% end %>
            </tbody>
        </table>
    </div>
</div>
<%= paginate domains, param_name: :domain_page %>