#domain-contacts
  - @domain_params['contacts_attributes'].each do |k, v|
    .panel.panel-default
      .panel-heading.clearfix
        .pull-left= t(:contact)
        .pull-right
          = link_to(t(:add_another), '#', class: 'btn btn-default btn-xs add-domain-contact')
          = link_to(t(:delete), '#', class: 'btn btn-default btn-xs destroy')
      .panel-body
        .form-group
          .col-md-3.control-label
            = label_tag "domain_contacts_attributes_#{k}_type", t(:contact_type), class: 'required'
          .col-md-7
            = select_tag "domain[contacts_attributes][#{k}][type]", options_for_select(['admin', 'tech'], v['type']), {class: 'form-control'}

        .form-group
          .col-md-3.control-label
            = label_tag "domain_contacts_attributes_#{k}_code", t(:contact_code), class: 'required'
          .col-md-7.has-feedback
            = select_tag "domain[contacts_attributes][#{k}][code]", 
              options_for_select(@contacts_autocomplete_map, selected: v['code']),
              include_blank: true, class: 'js-combobox', required: true

:coffee
  $("#domain-contacts").nestedAttributes
    bindAddTo: $(".add-domain-contact")
    afterAdd: (item) ->
      item.find('select').each (k, v) ->
        $(v).val($(v).find('option:first-child').val())


